<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<style type="text/css">
body{font:12px/1.231 arial,helvetica,clean,sans-serif;}
</style>

<!--More info on using custom base layers in Google Maps v3: http://code.google.com/apis/maps/documentation/v3/overlays.html#BaseMapTypes-->
<script type="text/javascript">
var latitude = 63;
var longitude = 10;
function StatkartMapType(name, layer) {
  this.layer = layer
  this.name = name
  this.alt = name
  this.tileSize = new google.maps.Size(256,256);
  this.maxZoom = 19;
  this.getTile = function(coord, zoom, ownerDocument) {
	    var div = ownerDocument.createElement('DIV');
	    div.style.width = this.tileSize.width + 'px';
	    div.style.height = this.tileSize.height + 'px';
	    div.style.backgroundImage = "url(http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=" + this.layer + "&zoom=" + zoom + "&x=" + coord.x + "&y=" + coord.y + ")";
	    return div;
	  };
}
var map;
function getPosition(position) {
	latitude = position.coords.latitude;
		longitude = position.coords.longitude;
		initialize();
}

function initialize() {
	var mapOptions = {zoom: 12, mapTypeControl: false, center: new google.maps.LatLng(latitude, longitude)};
	map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

	map.mapTypes.set('topo2',new StatkartMapType("Topografisk", "topo2"));

	map.setMapTypeId('topo2');
	var marker = new google.maps.Marker({position: new google.maps.LatLng(latitude, longitude), map: map});  

}
</script>
</head>
<body onload="navigator.geolocation.getCurrentPosition(getPosition);">
  <div id="map_canvas" style="width:600px; height:400px"></div> 
</body>


</html>